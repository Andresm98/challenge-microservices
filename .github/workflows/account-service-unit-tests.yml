name: Account Service Unit Tests

on:
  push:
    paths:
      - 'account-service/**'      # Solo cambios en account-service
  pull_request:
    paths:
      - 'account-service/**'

jobs:
  unit-tests:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è Checkout del repo
      - name: Checkout repository
        uses: actions/checkout@v3

      # 2 Setup JDK 17
      - name: Set up Java 17
        uses: actions/setup-java@v3
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Check Java & Maven versions
        run: |
          java -version
          mvn -v

      - name: Cache Maven packages
        uses: actions/cache@v3
        with:
          path: ~/.m2/repository
          key: ${{ runner.os }}-maven-${{ hashFiles('account-service/pom.xml') }}
          restore-keys: |
            ${{ runner.os }}-maven-


      - name: Run unit tests
        working-directory: account-service
        run: mvn -Dtest=*ServiceTest test


      - name: Show test reports
        working-directory: account-service
        run: cat target/surefire-reports/*.txt || true
